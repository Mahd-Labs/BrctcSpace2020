syntax = "proto3";

option csharp_namespace = "BrctcSpace";

package vibe2020;

import "google/protobuf/timestamp.proto";

service Vibe {
  rpc GetResultSet (ResultRequest) returns (ResultReply);
  rpc GetResultStream (ResultRequest) returns (stream ResultReply);
  rpc PollVibe2020DataService (DeviceDataRequest) returns (DeviceDataArray);
}

enum ResultType{
    GyroOnly = 0;
    AccelerometerOnly = 1;
    RtcOnly = 2;
    Full = 3;
}

message ResultRequest {
  ResultType ResultType = 1;
  bool scaleAccelerometer= 2;
}

message ResultReply {
  int32 ResultStatus = 1; //proto3 doesn't allow enum flags, so we'll send an integer and use a shared enum class
  ResultSet ResultSet = 2;
}

message ResultSet{
    AccelerometerResults AccelerometerResults = 1;
    GyroscopeResults GyroscopeResults = 2;
    double CpuTemperature = 3;
    google.protobuf.Timestamp CurrentTime = 4;
}

message AccelerometerResults{
    double X = 1;
    double Y = 2;
    double Z = 3;
}

message GyroscopeResults{
    BurstResults BurstResults = 1;
}

message BurstResults{
    double Diagnostic = 1;
    double Gyro_X = 2;
    double Gyro_Y = 3;
    double Gyro_Z = 4;
    double Accel_X = 5;
    double Accel_Y = 6;
    double Accel_Z = 7;
    double Temperature = 8;
    double SampleCount = 9;
    double Checksum = 10;
}

message DeviceDataRequest{
    bool useAccelerometer = 1;
    bool useGyroscope = 2;
    bool useRtc = 3;
    bool useCpuTemperature = 4;
}

message DeviceDataArray{
    repeated DeviceDataModel Items = 1;
}
message DeviceDataModel{
    repeated int32 AccelData = 1;
    repeated int32 GyroData = 2;
    int64 TransactionTime = 3;
    double CpuTemp = 4; 
}
